# .github/workflows/main.yml

name: Flask CI/CD

on:
  push:
    branches: [ "main" ] # main 브랜치에 푸시될 때 실행됩니다.

jobs:
  build:
    runs-on: ubuntu-latest # 실행 환경을 지정합니다.

    steps:
    - name: Checkout repository # 코드를 내려받습니다.
      uses: actions/checkout@v3

    - name: Set up Python # 파이썬 환경을 설정합니다.
      uses: actions/setup-python@v4
      with:
        python-version: '3.11' # pyproject.toml에 명시된 버전을 사용합니다.

    - name: Install dependencies # requirements.txt 파일로 라이브러리를 설치합니다.
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Run Gunicorn Server # Gunicorn으로 앱을 실행합니다 (배포 단계에서 사용).
      # 실제 배포 시에는 이 부분에 클라우드 제공업체로 배포하는 명령어를 작성합니다.
      # 아래는 테스트 목적으로 실행하는 예시입니다.
      run: gunicorn --bind 0.0.0.0:8000 main:app
